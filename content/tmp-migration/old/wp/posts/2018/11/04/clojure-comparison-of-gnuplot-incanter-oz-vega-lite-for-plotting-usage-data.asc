{:title
 "Clojure - comparison of gnuplot, Incanter, oz/vega-lite for plotting usage data",
 :date "2018-11-04",
 :layout :post,
 :tags ["clojure"],
 :tags-orig ["charting" "clojure" "data analysis"],
 :categories ["Languages" "[Dev]Ops"],
 :extra-css
 #{"https://github.githubassets.com/assets/gist-embed-123720f37c57ce9a8f29de081c38ed61.css"}
}

++++
What is the best way to plot memory and CPU usage data (mainly) in Clojure? I will compare gnuplot, Incanter with JFreeChart, and vega-lite (via Oz). (Spoiler: I like Oz/vega-lite most but still use Incanter to prepare the data.)<br><br>The data looks like this:<br><br><pre>;; sec.ns | memory | CPU %
1541052937.882172509 59m 0.0
1541052981.122419892 78m 58.0
1541052981.625876498 199m 85.9
1541053011.489811184 1.2g 101.8
</pre><br><br>The data has been produced by <a href="https://gist.github.com/holyjak/931a3441982c833f5f8fcdcf54d05c91">monitor-usage.sh</a>.<br><br><h2>The tools</h2><br><br><h4>Gnuplot 5</h4><br><br>Gnuplot is the simplest, with a lot available out of the box. But it is also somewhat archaic and little flexible.<br><br><!--more--><br><br>Here is the code:<div id="gist92505519" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-plot-usage-gp" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-gnuplot ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tr>
        <td id="file-plot-usage-gp-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-plot-usage-gp-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>!/usr/bin/env gnuplot --persist -c</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-plot-usage-gp-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> Plot memory and CPU usage over time. Usage:</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-plot-usage-gp-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>  usage-plot.gp &lt;input file&gt; [&lt;output .png file&gt;]</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-plot-usage-gp-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> where the input file has the columns `&lt;unix time&gt; &lt;memory, with m/g suffix&gt; &lt;% cpu&gt;`</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-plot-usage-gp-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> To create the input file, see https://gist.github.com/jakubholynet/931a3441982c833f5f8fcdcf54d05c91</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-plot-usage-gp-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-plot-usage-gp-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> Arguments:</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-plot-usage-gp-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">infile</span>=ARG<span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-plot-usage-gp-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">outfile</span>=ARG<span class="pl-c1">2</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-plot-usage-gp-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k">term x<span class="pl-c1">11</span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-plot-usage-gp-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">title</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Memory, CPU usage from<span class="pl-pds">&#39;</span></span> . infile</span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-plot-usage-gp-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">xdata</span> time</span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-plot-usage-gp-LC13" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">timefmt</span> <span class="pl-s"><span class="pl-pds">&quot;</span>%s<span class="pl-pds">&quot;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-plot-usage-gp-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">xlabel</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Time [[hh:]mm:ss]<span class="pl-pds">&quot;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-plot-usage-gp-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">ylabel</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Memory usage<span class="pl-pds">&quot;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-plot-usage-gp-LC16" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">for</span>mat y <span class="pl-s"><span class="pl-pds">&#39;</span>%.1s%cB<span class="pl-pds">&#39;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-plot-usage-gp-LC17" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-plot-usage-gp-LC18" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">y2label</span> <span class="pl-s"><span class="pl-pds">&#39;</span>CPU usage<span class="pl-pds">&#39;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-plot-usage-gp-LC19" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">for</span>mat y<span class="pl-c1">2</span> <span class="pl-s"><span class="pl-pds">&#39;</span>%.0s%%<span class="pl-pds">&#39;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-plot-usage-gp-LC20" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">y2tics</span> nomirror</span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-plot-usage-gp-LC21" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">tics</span> out</span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-plot-usage-gp-LC22" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">autoscale</span> y</span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-plot-usage-gp-LC23" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">autoscale</span> y<span class="pl-c1">2</span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-plot-usage-gp-LC24" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-plot-usage-gp-LC25" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> Credit: Christoph @ https://stackoverflow.com/a/52822256/204205</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-plot-usage-gp-LC26" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">resolveUnit</span>(s)=(<span class="pl-smi">pos</span>=<span class="pl-c1">strstrt</span>(<span class="pl-s"><span class="pl-pds">&quot;</span>kmgtp<span class="pl-pds">&quot;</span></span>,s[<span class="pl-ii">strl</span>e<span class="pl-ii">n</span>(<span class="pl-ii">s</span>)<span class="pl-k">:*</span>]), <span class="pl-c1">real</span>(s)*(<span class="pl-c1">1024</span>**pos))</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-plot-usage-gp-LC27" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-plot-usage-gp-LC28" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">exists</span>(<span class="pl-s"><span class="pl-pds">&quot;</span>outfile<span class="pl-pds">&quot;</span></span>) &amp;&amp; <span class="pl-c1">strlen</span>(outfile) &gt; <span class="pl-c1">0</span>) {</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-plot-usage-gp-LC29" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">print</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Outputting to the file <span class="pl-pds">&quot;</span></span>, outfile</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-plot-usage-gp-LC30" class="blob-code blob-code-inner js-file-line">    <span class="pl-k"><span class="pl-k">set</span> <span class="pl-k">term <span class="pl-c1">png</span> <span class="pl-c"><span class="pl-c">#</span> 640,480</span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-plot-usage-gp-LC31" class="blob-code blob-code-inner js-file-line">    <span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">output</span> outfile</span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-plot-usage-gp-LC32" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-plot-usage-gp-LC33" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-plot-usage-gp-LC34" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> Styling</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-plot-usage-gp-LC35" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">style</span> line <span class="pl-c1">1</span> <span class="pl-c1">linewidth</span> <span class="pl-c1">2</span> linecolor <span class="pl-s"><span class="pl-pds">&#39;</span>blue<span class="pl-pds">&#39;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-plot-usage-gp-LC36" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">style</span> line <span class="pl-c1">2</span> linecolor <span class="pl-s"><span class="pl-pds">&#39;</span>light-green<span class="pl-pds">&#39;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-plot-usage-gp-LC37" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>set xtics font &quot;, 10&quot;</span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-plot-usage-gp-LC38" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">tics</span> font <span class="pl-s"><span class="pl-pds">&quot;</span>, 10<span class="pl-pds">&quot;</span></span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-plot-usage-gp-LC39" class="blob-code blob-code-inner js-file-line"><span class="pl-k"><span class="pl-k">set</span> <span class="pl-k"><span class="pl-k">xtics</span> rotate <span class="pl-c1">60</span> <span class="pl-c"><span class="pl-c">#</span> put label every 60s, make vertical so they don&#39;t clash in .png if too many</span></span></span></td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-plot-usage-gp-LC40" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-plot-usage-gp-LC41" class="blob-code blob-code-inner js-file-line"><span class="pl-k">plot</span> infile <span class="pl-k">u</span> <span class="pl-c1">1</span>:<span class="pl-c1">3</span> <span class="pl-k">with</span> lp axes x<span class="pl-c1">1</span>y<span class="pl-c1">2</span> <span class="pl-k">title</span> <span class="pl-s"><span class="pl-pds">&quot;</span>cpu<span class="pl-pds">&quot;</span></span> <span class="pl-c1">linestyle</span> <span class="pl-c1">2</span>, \</td>
      </tr>
      <tr>
        <td id="file-plot-usage-gp-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-plot-usage-gp-LC42" class="blob-code blob-code-inner js-file-line">    infile <span class="pl-k">using</span> <span class="pl-c1">1</span>:(<span class="pl-smi">resolveUnit</span>(<span class="pl-smi">stringcolumn</span>(<span class="pl-c1">2</span>))) <span class="pl-k">with</span> <span class="pl-k">linespoints</span> <span class="pl-k">title</span> <span class="pl-s"><span class="pl-pds">&quot;</span>memory<span class="pl-pds">&quot;</span></span> <span class="pl-c1">linestyle</span> <span class="pl-c1">1</span></td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/holyjak/1b58dedae3207b4a56c9abcde5f3fdb5/raw/331569e176f4ab3c5ee8266f544a9cc01115f18f/plot-usage.gp" style="float:right">view raw</a>
        <a href="https://gist.github.com/holyjak/1b58dedae3207b4a56c9abcde5f3fdb5#file-plot-usage-gp">plot-usage.gp</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
<br><br>And here is an example output:<br><br><img title="Usage data in gnuplot" src="https://lh3.googleusercontent.com/kJgLplIChvJ37gBclTBrAI4hWO6Gf47ZGBA0MPJgPd9RgvLe77x_fHsT6VsJaCE52VQfVhRmlSj4JL-knc3nwzoQ_G_PUBUdChChcJqOZ1tBemc5dHuFZxXYeeCEHMFW5qwAUH0JZQB5Fx49ztkGOgM-tHhsvK2mPavjnuljLTbDG8Lr4FlucNVs47UhBBhrqYtV23zo5ttvuRP_2ULDxSYiM9SqpP8OFlQcVaUaKKXXpHeJG5ZGZnw5ZFuEdwnAPJ9L1ZGpHZBR3QJkt6cfLpNaIyIos84QLIVSPhyaUTkfj561uLF22YYiDdYvzvn_hJ4MMmsBqXLM_ErVzBocLlbUWMIEt8P9Fa4trqwS-3DjX_dxMzPNImggvDHMnfmIQASOZJOGWT1Qcg1agmNl6GU7dg4GUXFxLAltgpAavoUh63SDdE5TLQ_EttYOtl0TCOmzLhQseTkjLD15KBXiwXW29j-z-rrdq99bQttfI2zIov9CdmIG11CRTud0efwyj-cVe1VdJfLsyAWAdRA3IS7bisZHPxLGlNmclwb5a0TGoGm31YGjU0Of_YYKLSb_jZPDoF1gW1q3GJtn3Clzxku6ZkRnIrCt8HKtJ_-FHqVMd7aM2bVySkxdwOlmzmb0vHo3P3cjX2G1nupYPIHcUka3=w640-h480-no" /><br><br>Pros: Feature-rich (support bytes axis, two Y axes, reading data).<br><br>Cons: Archaic language, less flexible; I couldn't stop it from drawing X labels over each other when I had data for a longer period.<br><br><h4>Incanter (JFreeChart)</h4><br><br>Incanter is (was?) the go to tool for data analysis in Clojure and it includes the Java library JFreeChart for charting. There has been some development lately (integrating clojure.core.matrix) but otherwise it is quite stagnating. That's why there have been newer community efforts.<br><br>Here is the first part of the code, that prepares the data for charting (also used for Oz):<div id="gist92834543" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-usage-chart-preparation-clj" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-clojure ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tr>
        <td id="file-usage-chart-preparation-clj-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-usage-chart-preparation-clj-LC1" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">ns</span> <span class="pl-e">clj-charting.usage-chart-preparation</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-usage-chart-preparation-clj-LC2" class="blob-code blob-code-inner js-file-line">  (<span class="pl-c1">:require</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-usage-chart-preparation-clj-LC3" class="blob-code blob-code-inner js-file-line">    [incanter.core <span class="pl-c1">:refer</span> <span class="pl-c1">:all</span>]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-usage-chart-preparation-clj-LC4" class="blob-code blob-code-inner js-file-line">    [incanter.stats <span class="pl-c1">:as</span> s]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-usage-chart-preparation-clj-LC5" class="blob-code blob-code-inner js-file-line">    [incanter.io <span class="pl-c1">:as</span> io]))</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-usage-chart-preparation-clj-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-usage-chart-preparation-clj-LC7" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn-</span> <span class="pl-e">resolve-unit-suffix</span> </td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-usage-chart-preparation-clj-LC8" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>Replace values such as 333k, 800m, 1.2g with the corresponding value in bytes<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-usage-chart-preparation-clj-LC9" class="blob-code blob-code-inner js-file-line">  [val-suffixed]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-usage-chart-preparation-clj-LC10" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">if-let</span> [[_ val unit] (<span class="pl-en">and</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-usage-chart-preparation-clj-LC11" class="blob-code blob-code-inner js-file-line">                          (<span class="pl-en">string?</span> val-suffixed)</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-usage-chart-preparation-clj-LC12" class="blob-code blob-code-inner js-file-line">                          (<span class="pl-en">re-find</span> <span class="pl-sr">#&quot;(<span class="pl-cce">\d</span>+)([kmg])&quot;</span> val-suffixed))]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-usage-chart-preparation-clj-LC13" class="blob-code blob-code-inner js-file-line">    (<span class="pl-k">let</span> [order (<span class="pl-k">case</span> unit</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-usage-chart-preparation-clj-LC14" class="blob-code blob-code-inner js-file-line">                  <span class="pl-s"><span class="pl-pds">&quot;</span>k<span class="pl-pds">&quot;</span></span> <span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-usage-chart-preparation-clj-LC15" class="blob-code blob-code-inner js-file-line">                  <span class="pl-s"><span class="pl-pds">&quot;</span>m<span class="pl-pds">&quot;</span></span> <span class="pl-c1">2</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-usage-chart-preparation-clj-LC16" class="blob-code blob-code-inner js-file-line">                  <span class="pl-s"><span class="pl-pds">&quot;</span>g<span class="pl-pds">&quot;</span></span> <span class="pl-c1">3</span>)</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-usage-chart-preparation-clj-LC17" class="blob-code blob-code-inner js-file-line">          scale (<span class="pl-en">apply</span> * (<span class="pl-en">take</span> order (<span class="pl-en">repeat</span> <span class="pl-c1">1024</span>)))]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-usage-chart-preparation-clj-LC18" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">*</span> (<span class="pl-en">Integer/parseInt</span> val) scale))))</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-usage-chart-preparation-clj-LC19" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-usage-chart-preparation-clj-LC20" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">read-usage-data</span> </td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-usage-chart-preparation-clj-LC21" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>Read usage data in the form `sec.ns memory_with_scale_suffix CPU_percentage` into a dataset with</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-usage-chart-preparation-clj-LC22" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   `ms memory_in_bytes CPU_percentage`<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-usage-chart-preparation-clj-LC23" class="blob-code blob-code-inner js-file-line">  [file]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-usage-chart-preparation-clj-LC24" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [data (<span class="pl-en">io/read-dataset</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-usage-chart-preparation-clj-LC25" class="blob-code blob-code-inner js-file-line">               file</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-usage-chart-preparation-clj-LC26" class="blob-code blob-code-inner js-file-line">               <span class="pl-c1">:delim</span> \space)]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-usage-chart-preparation-clj-LC27" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">-&gt;</span> data</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-usage-chart-preparation-clj-LC28" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">;</span>; Memory: from 300m or 1g to a number:</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-usage-chart-preparation-clj-LC29" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">transform-col</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-usage-chart-preparation-clj-LC30" class="blob-code blob-code-inner js-file-line">          <span class="pl-c1">:col1</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-usage-chart-preparation-clj-LC31" class="blob-code blob-code-inner js-file-line">          resolve-unit-suffix)</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-usage-chart-preparation-clj-LC32" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">;</span>; CPU: From &lt;sec&gt;.&lt;nano&gt; to &lt;ms&gt;:</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-usage-chart-preparation-clj-LC33" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">transform-col</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-usage-chart-preparation-clj-LC34" class="blob-code blob-code-inner js-file-line">          <span class="pl-c1">:col0</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-usage-chart-preparation-clj-LC35" class="blob-code blob-code-inner js-file-line">          #(<span class="pl-en">long</span> (<span class="pl-en">*</span> <span class="pl-c1">1000</span> %))))))</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-usage-chart-preparation-clj-LC36" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-usage-chart-preparation-clj-LC37" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">moving-window-means</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-usage-chart-preparation-clj-LC38" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>Given very scattered data, produce a similar sequence of &#39;moving window mean&#39; where we</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-usage-chart-preparation-clj-LC39" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   replace each point by the mean of it and the preceding/following `radius` points.</span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-usage-chart-preparation-clj-LC40" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   <span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-usage-chart-preparation-clj-LC41" class="blob-code blob-code-inner js-file-line">  [radius col]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-usage-chart-preparation-clj-LC42" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [x&#39; (<span class="pl-en">concat</span> (<span class="pl-en">repeat</span> radius <span class="pl-c1">nil</span>) col)</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-usage-chart-preparation-clj-LC43" class="blob-code blob-code-inner js-file-line">        parts (<span class="pl-en">drop-last</span> radius (<span class="pl-en">partition</span> (<span class="pl-en">inc</span> (<span class="pl-en">*</span> <span class="pl-c1">2</span> radius)) <span class="pl-c1">1</span> x&#39;))</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-usage-chart-preparation-clj-LC44" class="blob-code blob-code-inner js-file-line">        means (<span class="pl-en">map</span> #(<span class="pl-en">-&gt;</span> (<span class="pl-en">remove</span> nil? %) s/mean long)</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-usage-chart-preparation-clj-LC45" class="blob-code blob-code-inner js-file-line">                   parts)]</td>
      </tr>
      <tr>
        <td id="file-usage-chart-preparation-clj-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-usage-chart-preparation-clj-LC46" class="blob-code blob-code-inner js-file-line">    means))</td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/holyjak/c4a88135bc08703d6351754980537055/raw/61b11246891cc3fa79052424746c523dda4e00c1/usage-chart-preparation.clj" style="float:right">view raw</a>
        <a href="https://gist.github.com/holyjak/c4a88135bc08703d6351754980537055#file-usage-chart-preparation-clj">usage-chart-preparation.clj</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
<br><br>And here is the code to format the chart (the most difficult part was to display kB / MB / GB values on the axis in a nice way; I really missed Gnuplot's out-of-the-box support here):<div id="gist92834675" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-incanter-clj" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-clojure ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tr>
        <td id="file-incanter-clj-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-incanter-clj-LC1" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">ns</span> <span class="pl-e">clj-charting.incanter</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-incanter-clj-LC2" class="blob-code blob-code-inner js-file-line">  (<span class="pl-c1">:require</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-incanter-clj-LC3" class="blob-code blob-code-inner js-file-line">    [incanter.core <span class="pl-c1">:refer</span> <span class="pl-c1">:all</span>]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-incanter-clj-LC4" class="blob-code blob-code-inner js-file-line">    [incanter.charts <span class="pl-c1">:refer</span> <span class="pl-c1">:all</span>]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-incanter-clj-LC5" class="blob-code blob-code-inner js-file-line">    [clj-charting.usage-chart-preparation <span class="pl-c1">:refer</span> [read-usage-data moving-window-means]])</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-incanter-clj-LC6" class="blob-code blob-code-inner js-file-line">  (<span class="pl-c1">:import</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-incanter-clj-LC7" class="blob-code blob-code-inner js-file-line">    [org.jfree.chart JFreeChart]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-incanter-clj-LC8" class="blob-code blob-code-inner js-file-line">    [org.jfree.chart.plot XYPlot]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-incanter-clj-LC9" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">org.jfree.chart.axis</span> ValueAxis NumberAxis NumberTickUnit TickUnitSource TickUnit)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-incanter-clj-LC10" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">java.text</span> NumberFormat DecimalFormat FieldPosition)))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-incanter-clj-LC11" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-incanter-clj-LC12" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">merge-y-axis</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-incanter-clj-LC13" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>Merge the Y axis of two line / time series charts. The former chart will have</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-incanter-clj-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-s">  the left Y axis, and the latter will have the right. Incanter does not support 2 Y</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-incanter-clj-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-s">  axes out of the box.</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-incanter-clj-LC16" class="blob-code blob-code-inner js-file-line"><span class="pl-s">  Source: https://matthewdowney.github.io/clojure-incanter-plot-multiple-y-axis.html<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-incanter-clj-LC17" class="blob-code blob-code-inner js-file-line">  [^JFreeChart chart ^JFreeChart chart-to-merge]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-incanter-clj-LC18" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [^XYPlot plot (<span class="pl-en">.getPlot</span> chart-to-merge)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-incanter-clj-LC19" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">doto</span> ^XYPlot (<span class="pl-en">.getPlot</span> chart)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-incanter-clj-LC20" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">.setRangeAxis</span> <span class="pl-c1">1</span> (<span class="pl-en">.getRangeAxis</span> plot))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-incanter-clj-LC21" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">.setDataset</span> <span class="pl-c1">1</span> (<span class="pl-en">.getDataset</span> plot))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-incanter-clj-LC22" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">.mapDatasetToRangeAxis</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span>)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-incanter-clj-LC23" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">.setRenderer</span> <span class="pl-c1">1</span> (<span class="pl-en">.getRenderer</span> plot)))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-incanter-clj-LC24" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">-&gt;</span> (<span class="pl-en">.getPlot</span> chart)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-incanter-clj-LC25" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">.getLegendItems</span>)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-incanter-clj-LC26" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">.addAll</span> (<span class="pl-en">.getLegendItems</span> plot)))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-incanter-clj-LC27" class="blob-code blob-code-inner js-file-line">    chart))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-incanter-clj-LC28" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-incanter-clj-LC29" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">byte-scale</span> </td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-incanter-clj-LC30" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>For the given number [in bytes] return [scale, scale suffix] so that we can divide it </span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-incanter-clj-LC31" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   by the scale and display with the corresponding suffix.</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-incanter-clj-LC32" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   Example: 2333 -&gt; [1024 <span class="pl-cce">\&quot;</span>kB<span class="pl-cce">\&quot;</span>]<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-incanter-clj-LC33" class="blob-code blob-code-inner js-file-line">  [num]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-incanter-clj-LC34" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [k <span class="pl-c1">1024</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-incanter-clj-LC35" class="blob-code blob-code-inner js-file-line">        m (<span class="pl-en">int</span> (<span class="pl-en">Math/pow</span> <span class="pl-c1">1024</span> <span class="pl-c1">2</span>))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-incanter-clj-LC36" class="blob-code blob-code-inner js-file-line">        g (<span class="pl-en">int</span> (<span class="pl-en">Math/pow</span> <span class="pl-c1">1024</span> <span class="pl-c1">3</span>))]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-incanter-clj-LC37" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">condp</span> &lt;= num</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-incanter-clj-LC38" class="blob-code blob-code-inner js-file-line">      g [g <span class="pl-s"><span class="pl-pds">&quot;</span>GB<span class="pl-pds">&quot;</span></span>]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-incanter-clj-LC39" class="blob-code blob-code-inner js-file-line">      m [m <span class="pl-s"><span class="pl-pds">&quot;</span>MB<span class="pl-pds">&quot;</span></span>]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-incanter-clj-LC40" class="blob-code blob-code-inner js-file-line">      k [k <span class="pl-s"><span class="pl-pds">&quot;</span>kB<span class="pl-pds">&quot;</span></span>]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-incanter-clj-LC41" class="blob-code blob-code-inner js-file-line">      [<span class="pl-c1">1</span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-pds">&quot;</span></span>])))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-incanter-clj-LC42" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-incanter-clj-LC43" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">format-bytes</span> </td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-incanter-clj-LC44" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>For the given number [in bytes] return [the number scaled down, the scale suffix such as <span class="pl-cce">\&quot;</span>kB<span class="pl-cce">\&quot;</span>].</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-incanter-clj-LC45" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   Example: 2333 -&gt; [2.278 <span class="pl-cce">\&quot;</span>kB<span class="pl-cce">\&quot;</span>]<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-incanter-clj-LC46" class="blob-code blob-code-inner js-file-line">  [num]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-incanter-clj-LC47" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [[scale unit] (<span class="pl-en">byte-scale</span> num)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-incanter-clj-LC48" class="blob-code blob-code-inner js-file-line">    [(<span class="pl-en">/</span> num scale) unit]))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-incanter-clj-LC49" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-incanter-clj-LC50" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">;</span>; Instance of NumberFormat that displays a byte number scaled down and with the scale suffix</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-incanter-clj-LC51" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">;</span>; Example: 2333 -&gt; \&quot;2.3kB\&quot;]&quot;</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-incanter-clj-LC52" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">def</span> <span class="pl-e">byteFmt</span> (<span class="pl-k">let</span> [dec-fmt (<span class="pl-en">java.text.DecimalFormat.</span> <span class="pl-s"><span class="pl-pds">&quot;</span>#.#<span class="pl-pds">&quot;</span></span>)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-incanter-clj-LC53" class="blob-code blob-code-inner js-file-line">               (<span class="pl-en">proxy</span> [java.text.NumberFormat] []</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-incanter-clj-LC54" class="blob-code blob-code-inner js-file-line">                 (<span class="pl-en">format</span> [^double number, ^StringBuffer toAppendTo, ^FieldPosition pos]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-incanter-clj-LC55" class="blob-code blob-code-inner js-file-line">                   (<span class="pl-k">let</span> [[n u] (<span class="pl-en">format-bytes</span> number)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-incanter-clj-LC56" class="blob-code blob-code-inner js-file-line">                     (<span class="pl-en">.append</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-incanter-clj-LC57" class="blob-code blob-code-inner js-file-line">                       (<span class="pl-en">.format</span> dec-fmt n toAppendTo pos)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-incanter-clj-LC58" class="blob-code blob-code-inner js-file-line">                       u))))))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-incanter-clj-LC59" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-incanter-clj-LC60" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">nearest-byte-tick</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-incanter-clj-LC61" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>For the given byte number, find out what tick to show on the axis; </span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-incanter-clj-LC62" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   e.g. we would rather see a tick such as &#39;800MB&#39; than &#39;783.5MB&#39; on it.<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-incanter-clj-LC63" class="blob-code blob-code-inner js-file-line">  ([^double size tick-fn]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-incanter-clj-LC64" class="blob-code blob-code-inner js-file-line">   (<span class="pl-k">let</span> [[scale] (<span class="pl-en">byte-scale</span> size)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-incanter-clj-LC65" class="blob-code blob-code-inner js-file-line">     (<span class="pl-en">NumberTickUnit.</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-incanter-clj-LC66" class="blob-code blob-code-inner js-file-line">       (<span class="pl-en">*</span> scale</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-incanter-clj-LC67" class="blob-code blob-code-inner js-file-line">          <span class="pl-c"><span class="pl-c">;</span>; FIXME if size = 1000 upgrade to 1024</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-incanter-clj-LC68" class="blob-code blob-code-inner js-file-line">          (<span class="pl-en">.getSize</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-incanter-clj-LC69" class="blob-code blob-code-inner js-file-line">            (<span class="pl-en">tick-fn</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-incanter-clj-LC70" class="blob-code blob-code-inner js-file-line">              (<span class="pl-en">NumberTickUnit.</span> (<span class="pl-en">/</span> size scale)))))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-incanter-clj-LC71" class="blob-code blob-code-inner js-file-line">       byteFmt))))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-incanter-clj-LC72" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-incanter-clj-LC73" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">def</span> <span class="pl-e">byte-tick-source</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-incanter-clj-LC74" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>TickUnitSource suitable for byte values spanning multiple of kB - MB - GB<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-incanter-clj-LC75" class="blob-code blob-code-inner js-file-line">  <span class="pl-c"><span class="pl-c">;</span>; TODO Instead of reusing IntegerTickUnits, reimplement it to support powers of 2</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-incanter-clj-LC76" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [int-tick-units (<span class="pl-en">NumberAxis/createIntegerTickUnits</span>)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-incanter-clj-LC77" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">reify</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-incanter-clj-LC78" class="blob-code blob-code-inner js-file-line">      TickUnitSource</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-incanter-clj-LC79" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">^TickUnit</span> getLargerTickUnit [_ ^TickUnit unit]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L80" class="blob-num js-line-number" data-line-number="80"></td>
        <td id="file-incanter-clj-LC80" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">nearest-byte-tick</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L81" class="blob-num js-line-number" data-line-number="81"></td>
        <td id="file-incanter-clj-LC81" class="blob-code blob-code-inner js-file-line">          (<span class="pl-en">.getSize</span> unit)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L82" class="blob-num js-line-number" data-line-number="82"></td>
        <td id="file-incanter-clj-LC82" class="blob-code blob-code-inner js-file-line">          #(<span class="pl-en">.getLargerTickUnit</span> int-tick-units %)))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L83" class="blob-num js-line-number" data-line-number="83"></td>
        <td id="file-incanter-clj-LC83" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">^TickUnit</span> getCeilingTickUnit [me ^TickUnit unit]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L84" class="blob-num js-line-number" data-line-number="84"></td>
        <td id="file-incanter-clj-LC84" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">.getCeilingTickUnit</span> me (<span class="pl-en">.getSize</span> unit)))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L85" class="blob-num js-line-number" data-line-number="85"></td>
        <td id="file-incanter-clj-LC85" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">^TickUnit</span> getCeilingTickUnit [_ ^double size]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L86" class="blob-num js-line-number" data-line-number="86"></td>
        <td id="file-incanter-clj-LC86" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">nearest-byte-tick</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L87" class="blob-num js-line-number" data-line-number="87"></td>
        <td id="file-incanter-clj-LC87" class="blob-code blob-code-inner js-file-line">          size</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L88" class="blob-num js-line-number" data-line-number="88"></td>
        <td id="file-incanter-clj-LC88" class="blob-code blob-code-inner js-file-line">          #(<span class="pl-en">.getCeilingTickUnit</span> int-tick-units %))))))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L89" class="blob-num js-line-number" data-line-number="89"></td>
        <td id="file-incanter-clj-LC89" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L90" class="blob-num js-line-number" data-line-number="90"></td>
        <td id="file-incanter-clj-LC90" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">set-bytes-tick-unit</span> [^JFreeChart chart]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L91" class="blob-num js-line-number" data-line-number="91"></td>
        <td id="file-incanter-clj-LC91" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [^XYPlot plot (<span class="pl-en">.getPlot</span> chart)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L92" class="blob-num js-line-number" data-line-number="92"></td>
        <td id="file-incanter-clj-LC92" class="blob-code blob-code-inner js-file-line">        ^NumberAxis axis (<span class="pl-en">.getRangeAxis</span> plot)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L93" class="blob-num js-line-number" data-line-number="93"></td>
        <td id="file-incanter-clj-LC93" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">.setStandardTickUnits</span> axis byte-tick-source)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L94" class="blob-num js-line-number" data-line-number="94"></td>
        <td id="file-incanter-clj-LC94" class="blob-code blob-code-inner js-file-line">    chart))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L95" class="blob-num js-line-number" data-line-number="95"></td>
        <td id="file-incanter-clj-LC95" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L96" class="blob-num js-line-number" data-line-number="96"></td>
        <td id="file-incanter-clj-LC96" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L97" class="blob-num js-line-number" data-line-number="97"></td>
        <td id="file-incanter-clj-LC97" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">plot-usage</span> [file]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L98" class="blob-num js-line-number" data-line-number="98"></td>
        <td id="file-incanter-clj-LC98" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [data (<span class="pl-en">read-usage-data</span> file)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L99" class="blob-num js-line-number" data-line-number="99"></td>
        <td id="file-incanter-clj-LC99" class="blob-code blob-code-inner js-file-line">        time (<span class="pl-en">sel</span> data <span class="pl-c1">:cols</span> <span class="pl-c1">0</span>)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L100" class="blob-num js-line-number" data-line-number="100"></td>
        <td id="file-incanter-clj-LC100" class="blob-code blob-code-inner js-file-line">        mem (<span class="pl-en">sel</span> data <span class="pl-c1">:cols</span> <span class="pl-c1">1</span>)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L101" class="blob-num js-line-number" data-line-number="101"></td>
        <td id="file-incanter-clj-LC101" class="blob-code blob-code-inner js-file-line">        cpu (<span class="pl-en">sel</span> data <span class="pl-c1">:cols</span> <span class="pl-c1">2</span>)]</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L102" class="blob-num js-line-number" data-line-number="102"></td>
        <td id="file-incanter-clj-LC102" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">-&gt;</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L103" class="blob-num js-line-number" data-line-number="103"></td>
        <td id="file-incanter-clj-LC103" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">time-series-plot</span> time cpu <span class="pl-c1">:title</span> file <span class="pl-c1">:y-label</span> <span class="pl-s"><span class="pl-pds">&quot;</span>cpu [%]<span class="pl-pds">&quot;</span></span>  <span class="pl-c1">:legend</span> <span class="pl-c1">true</span>)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L104" class="blob-num js-line-number" data-line-number="104"></td>
        <td id="file-incanter-clj-LC104" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">add-lines</span> time (<span class="pl-en">moving-window-means</span> <span class="pl-c1">60</span> cpu) <span class="pl-c1">:series-label</span> <span class="pl-s"><span class="pl-pds">&quot;</span>cpu (mean)<span class="pl-pds">&quot;</span></span>)</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L105" class="blob-num js-line-number" data-line-number="105"></td>
        <td id="file-incanter-clj-LC105" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">merge-y-axis</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L106" class="blob-num js-line-number" data-line-number="106"></td>
        <td id="file-incanter-clj-LC106" class="blob-code blob-code-inner js-file-line">        (<span class="pl-en">set-bytes-tick-unit</span></td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L107" class="blob-num js-line-number" data-line-number="107"></td>
        <td id="file-incanter-clj-LC107" class="blob-code blob-code-inner js-file-line">          (<span class="pl-en">time-series-plot</span> time mem <span class="pl-c1">:series-label</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Memory<span class="pl-pds">&quot;</span></span>)))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L108" class="blob-num js-line-number" data-line-number="108"></td>
        <td id="file-incanter-clj-LC108" class="blob-code blob-code-inner js-file-line">      (<span class="pl-en">view</span>))))</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L109" class="blob-num js-line-number" data-line-number="109"></td>
        <td id="file-incanter-clj-LC109" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-incanter-clj-L110" class="blob-num js-line-number" data-line-number="110"></td>
        <td id="file-incanter-clj-LC110" class="blob-code blob-code-inner js-file-line">(<span class="pl-en">plot-usage</span> <span class="pl-s"><span class="pl-pds">&quot;</span>siege-c10-all-urls-async-node11.dat<span class="pl-pds">&quot;</span></span>)</td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/holyjak/4b22d6810ea16df940224a77f0db9dcc/raw/a981d621da9e191aafaf4515376d3d1594514e5e/incanter.clj" style="float:right">view raw</a>
        <a href="https://gist.github.com/holyjak/4b22d6810ea16df940224a77f0db9dcc#file-incanter-clj">incanter.clj</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
<br><br>That is quite insane amount of work, huh? And the result:<br><br><img title="Usage - Incanter" src="https://lh3.googleusercontent.com/cArgyyZNtCUyT_c4qcenImGkQPQgeyOG-rQyy6Ykb48ETv1GGL6VpSdbJ3mRCw84NnSKdEXm4O7t4Ool-43RDMENdRrnZweiiFZCtqIOAajo2-zmtf9_riqcYJlO13sA5SZX7jMKSGsgaQQUaaX5uQsNPQiKh6zTj0w_pEWz-5KqW1Y3rqJK2NuXYHiMBJ9S-ItbR1MPMmBLC4EnusG8KfoEdDA-s6_c0y2xAiCB3H2fpYECMYxQbUoVoC0kjYLJ6sY3jwREKPHNvm1xzZ7cXsRYGO5VZSrURyilOwzpkYGjpoVMoRIMJYAVVr6GSoScO96npyPn3bNUmSG8pBUQmrz5sDX4Uajnw7ro4SabBQQzHf9LKz9_lxYKdGsk2PNFKtIaCbz-INE2lxkVTuJ9OIbl3Bkgpt2bbP3TdBXH8uIFoHGPLZAtn_BZdDV5CMoixYK4kh3tEGnaPUFmCAp-ZrEX-k6h5PInQMoCd6LK9TI-xtCXMj2xPO5G4Ma0Vn0sab7Z8-D4MrIn4JlmYRD_hMakyd2cZ9DXZRNt7ojQNMi5vzSD3SVFu40aEAZMrQ1V7gZOJf1wYmjIUjK790bWGEd_q5FHGiNvPmba9c1phYJXV-LkduoMAyBD6g8ILT6HMpEYqI0LImaiz7POnCVYDIOV=w500-h378-no" /><br><br><h4>vega-lite via Oz</h4><br><br><blockquote>Vega and Vega-lite visualization grammars: Vega is a declarative format for creating, saving, and sharing visualization designs. With Vega, visualizations are described in JSON, and generate interactive views using either HTML5 Canvas or SVG.</blockquote><br><br><a href="https://vega.github.io/">Vega-lite (and Vega</a>) is the new kid on the block. It has learned a lot from D3 and R's ggplot2 and is intended for data exploration, interactive charts, and making it possible to combine multiple charts on the same page - while making this as simple as possible. It is based on the Grammar of Graphics so it is presumabely well thought-through.<br><br><a href="https://github.com/metasoarous/oz/">Oz</a> is a thin wrapper around vega/vega-lite that makes it possible to interact with the browser from Clojure REPL, with Clojure data.<br><br>(Note: Oz currently uses VL v2.6 while the latest VL is v3rc8, which fixes some limitations in v2.)<br><br>As mentioned above, we use the same <a href="https://gist.github.com/holyjak/c4a88135bc08703d6351754980537055">usage-chart-preparation.clj</a> as the pure-Incanter example to prepare the data for charting. Then, to plot them:<div id="gist92834743" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-oz-clj" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-clojure ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tr>
        <td id="file-oz-clj-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-oz-clj-LC1" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">ns</span> <span class="pl-e">clj-charting.oz</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-oz-clj-LC2" class="blob-code blob-code-inner js-file-line">  (<span class="pl-c1">:require</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-oz-clj-LC3" class="blob-code blob-code-inner js-file-line">    [oz.core <span class="pl-c1">:as</span> oz]</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-oz-clj-LC4" class="blob-code blob-code-inner js-file-line">    [incanter.core <span class="pl-c1">:refer</span> <span class="pl-c1">:all</span>]</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-oz-clj-LC5" class="blob-code blob-code-inner js-file-line">    [clj-charting.usage-chart-preparation <span class="pl-c1">:refer</span> [read-usage-data moving-window-means]]))</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-oz-clj-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-oz-clj-LC7" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">defn</span> <span class="pl-e">dataset-&gt;map-list</span> </td>
      </tr>
      <tr>
        <td id="file-oz-clj-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-oz-clj-LC8" class="blob-code blob-code-inner js-file-line">  <span class="pl-s"><span class="pl-pds">&quot;</span>Incanter dataset into a list of maps like </span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-oz-clj-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-s">   {<span class="pl-cce">\&quot;</span>0<span class="pl-cce">\&quot;</span> 1541065398391, <span class="pl-cce">\&quot;</span>1<span class="pl-cce">\&quot;</span> 446693376, <span class="pl-cce">\&quot;</span>2<span class="pl-cce">\&quot;</span> 99.9, <span class="pl-cce">\&quot;</span>cpu_mean<span class="pl-cce">\&quot;</span> 89}<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-oz-clj-LC10" class="blob-code blob-code-inner js-file-line">  [ds]</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-oz-clj-LC11" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [rows (<span class="pl-en">to-list</span> ds)</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-oz-clj-LC12" class="blob-code blob-code-inner js-file-line">        means (<span class="pl-en">moving-window-means</span> <span class="pl-c1">60</span> (<span class="pl-en">sel</span> ds <span class="pl-c1">:cols</span> <span class="pl-c1">2</span>))]</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-oz-clj-LC13" class="blob-code blob-code-inner js-file-line">    (<span class="pl-en">map</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-oz-clj-LC14" class="blob-code blob-code-inner js-file-line">      #(<span class="pl-en">assoc</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-oz-clj-LC15" class="blob-code blob-code-inner js-file-line">         (<span class="pl-en">zipmap</span> (<span class="pl-en">map</span> str (<span class="pl-en">range</span>)) %<span class="pl-c1">1</span>)</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-oz-clj-LC16" class="blob-code blob-code-inner js-file-line">         <span class="pl-s"><span class="pl-pds">&quot;</span>cpu_mean<span class="pl-pds">&quot;</span></span> %<span class="pl-c1">2</span>)</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-oz-clj-LC17" class="blob-code blob-code-inner js-file-line">      rows</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-oz-clj-LC18" class="blob-code blob-code-inner js-file-line">      means)))</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-oz-clj-LC19" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-oz-clj-LC20" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">;</span>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-oz-clj-LC21" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-oz-clj-LC22" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">def</span> <span class="pl-e">gb4</span> (<span class="pl-en">*</span> <span class="pl-c1">3</span> <span class="pl-c1">1024</span> <span class="pl-c1">1024</span> <span class="pl-c1">1024</span>))</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-oz-clj-LC23" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-oz-clj-LC24" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">;</span>; TODO Display legend - IMPOSSIBLE :-( until Datum</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-oz-clj-LC25" class="blob-code blob-code-inner js-file-line">(<span class="pl-k">def</span> <span class="pl-e">line-plot</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-oz-clj-LC26" class="blob-code blob-code-inner js-file-line">  (<span class="pl-k">let</span> [data (<span class="pl-en">dataset-&gt;map-list</span> (<span class="pl-en">read-usage-data</span> <span class="pl-s"><span class="pl-pds">&quot;</span>siege-c10-all-urls-async-node11.dat<span class="pl-pds">&quot;</span></span>))</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-oz-clj-LC27" class="blob-code blob-code-inner js-file-line">        x-enc {<span class="pl-c1">:field</span> <span class="pl-s"><span class="pl-pds">&quot;</span>0<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-oz-clj-LC28" class="blob-code blob-code-inner js-file-line">               <span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>temporal<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-oz-clj-LC29" class="blob-code blob-code-inner js-file-line">               <span class="pl-c1">:timeUnit</span> <span class="pl-s"><span class="pl-pds">&quot;</span>hoursminutesseconds<span class="pl-pds">&quot;</span></span> <span class="pl-c"><span class="pl-c">;</span> :aggregate &quot;mean&quot; l &lt;- this kills points with same value</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-oz-clj-LC30" class="blob-code blob-code-inner js-file-line">               <span class="pl-c1">:axis</span> {<span class="pl-c1">:title</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Time<span class="pl-pds">&quot;</span></span>}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-oz-clj-LC31" class="blob-code blob-code-inner js-file-line">               <span class="pl-c1">:scale</span> {<span class="pl-c1">:zero</span> <span class="pl-c1">false</span>}}]</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-oz-clj-LC32" class="blob-code blob-code-inner js-file-line">    {<span class="pl-c1">:width</span> <span class="pl-c1">700</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-oz-clj-LC33" class="blob-code blob-code-inner js-file-line">     <span class="pl-c1">:data</span> {<span class="pl-c1">:values</span> data}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-oz-clj-LC34" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-oz-clj-LC35" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span>;; 👇 requires VL v3 until then we have to compute cpu_mean using Incanter</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-oz-clj-LC36" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span>:transform [{:window [{:op &quot;mean&quot;</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-oz-clj-LC37" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span>                       :field &quot;1&quot;</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-oz-clj-LC38" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span>                       :as &quot;cpu_mean&quot;}]</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-oz-clj-LC39" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span>             :frame [-10, 10]}]</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-oz-clj-LC40" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span> TODO VLv3: use this 👇 instead of repeating the X on each plot</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-oz-clj-LC41" class="blob-code blob-code-inner js-file-line">     <span class="pl-c"><span class="pl-c">;</span>:encoding {:x x-enc}</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-oz-clj-LC42" class="blob-code blob-code-inner js-file-line">     <span class="pl-c1">:layer</span> [{<span class="pl-c1">:mark</span> {<span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>line<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-oz-clj-LC43" class="blob-code blob-code-inner js-file-line">                     <span class="pl-c1">:clip</span> <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-oz-clj-LC44" class="blob-code blob-code-inner js-file-line">                     <span class="pl-c1">:color</span> <span class="pl-s"><span class="pl-pds">&quot;</span>red<span class="pl-pds">&quot;</span></span>}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-oz-clj-LC45" class="blob-code blob-code-inner js-file-line">              <span class="pl-c1">:encoding</span> {<span class="pl-c1">:x</span> x-enc</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-oz-clj-LC46" class="blob-code blob-code-inner js-file-line">                         <span class="pl-c1">:y</span> {<span class="pl-c1">:field</span> <span class="pl-s"><span class="pl-pds">&quot;</span>1<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-oz-clj-LC47" class="blob-code blob-code-inner js-file-line">                             <span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>quantitative<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-oz-clj-LC48" class="blob-code blob-code-inner js-file-line">                             <span class="pl-c1">:axis</span> {<span class="pl-c1">:format</span> <span class="pl-s"><span class="pl-pds">&quot;</span>.1s<span class="pl-pds">&quot;</span></span> <span class="pl-c1">:title</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Memory<span class="pl-pds">&quot;</span></span> <span class="pl-c1">:labelColor</span> <span class="pl-s"><span class="pl-pds">&quot;</span>red<span class="pl-pds">&quot;</span></span> #_<span class="pl-s"><span class="pl-pds">&quot;</span>required VL 3<span class="pl-pds">&quot;</span></span>}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-oz-clj-LC49" class="blob-code blob-code-inner js-file-line">                             <span class="pl-c1">:scale</span> {<span class="pl-c1">:domain</span> [<span class="pl-c1">0</span> gb4]}}}}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-oz-clj-LC50" class="blob-code blob-code-inner js-file-line">             {<span class="pl-c1">:layer</span> [</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-oz-clj-LC51" class="blob-code blob-code-inner js-file-line">                      {<span class="pl-c1">:mark</span> {<span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>point<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-oz-clj-LC52" class="blob-code blob-code-inner js-file-line">                              <span class="pl-c1">:clip</span> <span class="pl-c1">true</span>}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-oz-clj-LC53" class="blob-code blob-code-inner js-file-line">                       <span class="pl-c1">:encoding</span> {<span class="pl-c1">:x</span> x-enc</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-oz-clj-LC54" class="blob-code blob-code-inner js-file-line">                                  <span class="pl-c1">:y</span> {<span class="pl-c1">:field</span> <span class="pl-s"><span class="pl-pds">&quot;</span>2<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-oz-clj-LC55" class="blob-code blob-code-inner js-file-line">                                      <span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>quantitative<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-oz-clj-LC56" class="blob-code blob-code-inner js-file-line">                                      <span class="pl-c1">:axis</span> {<span class="pl-c1">:title</span> <span class="pl-s"><span class="pl-pds">&quot;</span>CPU [%]<span class="pl-pds">&quot;</span></span> <span class="pl-c1">:labelColor</span> <span class="pl-s"><span class="pl-pds">&quot;</span>blue<span class="pl-pds">&quot;</span></span>}}}}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-oz-clj-LC57" class="blob-code blob-code-inner js-file-line">                      {<span class="pl-c1">:mark</span> {<span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>line<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-oz-clj-LC58" class="blob-code blob-code-inner js-file-line">                              <span class="pl-c1">:clip</span> <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-oz-clj-LC59" class="blob-code blob-code-inner js-file-line">                              <span class="pl-c1">:color</span> <span class="pl-s"><span class="pl-pds">&quot;</span>blue<span class="pl-pds">&quot;</span></span>}</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-oz-clj-LC60" class="blob-code blob-code-inner js-file-line">                       <span class="pl-c1">:encoding</span> {<span class="pl-c1">:x</span> x-enc</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-oz-clj-LC61" class="blob-code blob-code-inner js-file-line">                                  <span class="pl-c1">:y</span> {<span class="pl-c1">:field</span> <span class="pl-s"><span class="pl-pds">&quot;</span>cpu_mean<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-oz-clj-LC62" class="blob-code blob-code-inner js-file-line">                                      <span class="pl-c1">:type</span> <span class="pl-s"><span class="pl-pds">&quot;</span>quantitative<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-oz-clj-LC63" class="blob-code blob-code-inner js-file-line">                                      <span class="pl-c1">:title</span> <span class="pl-c1">nil</span></td>
      </tr>
      <tr>
        <td id="file-oz-clj-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-oz-clj-LC64" class="blob-code blob-code-inner js-file-line">                                      <span class="pl-c1">:axis</span> <span class="pl-c1">nil</span>}}}]}]</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-oz-clj-LC65" class="blob-code blob-code-inner js-file-line">     <span class="pl-c1">:resolve</span> {<span class="pl-c1">:scale</span> {<span class="pl-c1">:y</span> <span class="pl-s"><span class="pl-pds">&quot;</span>independent<span class="pl-pds">&quot;</span></span>}}}))</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-oz-clj-LC66" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-oz-clj-LC67" class="blob-code blob-code-inner js-file-line">(<span class="pl-en">oz/start-plot-server!</span>)</td>
      </tr>
      <tr>
        <td id="file-oz-clj-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-oz-clj-LC68" class="blob-code blob-code-inner js-file-line">(<span class="pl-en">oz/v!</span> line-plot)</td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/holyjak/c57c6e31d515259ed05f5a520571bb2c/raw/9dae12b198167c203226798c7d1e57072a867987/oz.clj" style="float:right">view raw</a>
        <a href="https://gist.github.com/holyjak/c57c6e31d515259ed05f5a520571bb2c#file-oz-clj">oz.clj</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
<br><br>It is more work than in Gnuplot but it provides more value and is much more powerful.<br><br>Here is the output (generated with VL v3 so the labels have the same color as the lines):<br><br><img title="Usage - vega-lite" src="https://lh3.googleusercontent.com/pLrcmcx7gW2sR4m33MCpsACUGGW9wsf0tdXBZ6wG7cD-fgdZH36fAZBF6hyimXhWap5OZ_MqCLp4NTXs3n5FUQS9trXh1g0RzVo40gJ0SFpis6nHHL8mGLb2WN5Y_kVd2jCTMKJ8nWk2I051UA6p-HbPdYx3isZaN-6qOQLYkj2bS-WPtMNlsGkPqyqeVF-gHC54WPiXSisLQpqi8WHVm5rcx6PqsvY5YIKHGJSgWX9FXGh31bxP32a9NcNwHIWr-5IE12ZeTmIeV2aDH66ixfLhEJ2WiFn6IFj1VITHnbVXYiIkhCytt8_u4rvJboUWMPHYVyP412s2wF7zXBJNGH-HJuZ-phpmCAGJsf4a6iIc_xcRs7kanN2G7MG7z8Zb0PnIToSb3TZFsIZaG6rfkH_AX9tuW3xQdesnmZ0XYhWndPAqUDtLvdgsk_6R6PZ4DuXuZwPudaxzevCtAS9fOYtCgBmVC2WfNICeuJrvFq3BzBlDNOBICBVTEPhpDGTQ-GXmPOpU27ILloNDdA5W7r4SrC_EUACfv6B8ApMLl1bTC9Z-lGVQm_k4m-PRdBuf2fD-f30-SjbGkv7t3Pivfri1BjCIBeFxM7ElGFq4URaMi8PeJ148cFftDSRp6fcB3xULhWLqHmcDt3321OWkCW6y=w804-h251-no" /><br><br>The awesome thing is that the chart and data can be encoded in an URL so that you can <a>open in in the online Vega Editor and play with it</a>.<br><br>Pros: Good and powerful design, modern, interactive, promising.<br><br>Cons: The community is very small so it is harder to get help, it isn't so mature yet (e.g. it was impossible to add a legend to my multi-layer chart). You have to transform your data into JSON so it likely isn't suitable for huge amounts of it.<br><br><h4>Other options</h4><br><br><a href="https://github.com/clojurewerkz/envision">Clojurewerkz/envision</a> is "a small, easy to use Clojure library for data processing, cleanup and visualisation. [..] Main idea of this library is to make exploratory analysis more interactive and visual, although in programmer's way." ClojureWerkz is known for its commitment to project quality and maintenance so that is good, on the other hand the last code change has been 2 years ago.<br><br>Outside of Clojure, I would expect Python to have some very good charting libraries.<br><br><h2>Conclusion</h2><br><br>Nothing is optimal :-) but vega-lite is very promising, I will continue to use it - and I will also still use Incanter to process and prepare the data.
++++
